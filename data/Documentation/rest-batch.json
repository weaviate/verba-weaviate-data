{"text": "\n\n## Batch create objects\n\nFor sending data objects to Weaviate in bulk.\n\n### Performance\n\nFor best performance, we recommend using batching for insertion and deletion. Also consider that:\n\n1. The vectorization module/tool may be acting as a bottleneck.\n1. Avoid duplicate vectors for multiple data objects.\n1. Object-level errors may occur even if the batch request is successful.\n1. If your import slows down after a particular number of objects (e.g. 2M), check to see if the `vectorCacheMaxObjects` in your schema is larger than the number of objects. Also, see this example.\n\n### Method and URL\n\n```js\nPOST /v1/batch/objects[?consistency_level=ONE|QUORUM|ALL]\n```\n\n### Parameters\n\nThe URL supports an optional consistency level query parameter:\n\n| Name | Location | Type | Description |\n| ---- | -------- | ---- |------------ |\n| `consistency_level` | query param | string | Optional consistency level: `ONE`, `QUORUM` (default) or `ALL`. |\n\nThe POST body requires the following field:\n\n| Name | Type | Required | Description |\n| ---- | ---- | ---- | ---- |\n| `objects` | array of data objects | yes | Array of objects |\n\n### Multi-tenancy\n\nYou can use batching in collections with multi-tenancy is enabled. For example, batch creation of objects works similarly to single object creation, by passing the `tenant` parameter in the object body.\n\n### Example request\n\n\n\n\n\n## Batch create references\n\nFor batch adding cross-references between data objects in bulk.\n\n### Method and URL\n\n```js\nPOST /v1/batch/references\n```\n\n### Parameters\n\nThe URL supports an optional consistency level query parameter:\n\n| Name | Location | Type | Description |\n| ---- | -------- | ---- |------------ |\n| `consistency_level` | query param | string | Optional consistency level: `ONE`, `QUORUM` (default) or `ALL`. |\n\nThe POST body is an array of elements with the following fields:\n\n| Name | Type | Required | Description |\n| ---- | ---- | -------- | ----------- |\n| `from` | Weaviate Beacon (long-form) | yes | The beacon, with the cross-reference property name at the end: `weaviate://localhost/{CollectionName}/{id}/{crefPropertyName}` |\n| `to` | Weaviate Beacon (regular) | yes | The beacon, formatted as `weaviate://localhost/{CollectionName}/{id}` |\n\nFor backward compatibility, you can omit the collection name in the\nshort-form beacon format that is used for `to`. You can specify it as\n`weaviate://localhost/{id}`. This is, however, considered deprecated and will be\nremoved with a future release, as duplicate IDs across collections could mean that\nthis beacon is not uniquely identifiable. For the long-form beacon - used as part\nof `from` - you always need to specify the full beacon, including the reference\nproperty name.\n\n### Example request\n\n\n\n\n## Batch delete\n\nYou can use the HTTP verb `DELETE` on the `/v1/batch/objects` endpoint to delete all objects that match a particular expression.\n\nThe request body takes a single where Filter and will delete all objects matched. It also returns the number of matched objects and potential errors. Note that there is a limit to the number of objects to be deleted at once using this filter.\n\n### Maximum number of deletes per query\n\nThere is an upper limit (`QUERY_MAXIMUM_RESULTS`) to how many objects can be deleted using a single query. This protects against unexpected memory surges and very-long-running requests which would be prone to client-side timeouts or network interruptions.\n\nObjects are deleted in the same order that they would be returned in an equivalent Get query. To delete more objects than the limit, run the same query multiple times until no objects are matched anymore.\n\nThe default `QUERY_MAXIMUM_RESULTS` value is 10,000. This may be configurable, e.g. in the environment variables.\n\n\n### Dry-run before deletion\n\nSet the dry-run option to show which objects would be matched using the specified filter without deleting any objects. Depending on the configured verbosity, you will either receive a count of affected objects, or a list of IDs.\n\n### Method and URL\n\n```js\nDELETE /v1/batch/objects[?consistency_level=ONE|QUORUM|ALL]\n```\n\n### Parameters\n\nThe URL supports an optional consistency level query parameter:\n\n| Name | Location | Type | Description |\n| ---- | -------- | ---- |------------ |\n| `consistency_level` | query param | string | Optional consistency level: `ONE`, `QUORUM` (default) or `ALL`. |\n\nThe body requires the following fields:\n\n| Name | Type | Required | Description |\n| ---- | ---- | -------- | ----------- |\n| `match` | object | yes | Object outlining how to find the objects to be deleted (see example below) |\n| `output` | string | no | Optional verbosity level, `minimal` (default) or `verbose` |\n| `dryRun` | bool | no | If true, objects will not be deleted yet, but merely listed. Defaults to `false`. |\n\n#### A request body in detail\n\n```yaml\n{\n  \"match\": {\n    \"class\": \"\",  # required\n    \"where\": { /* where filter object */ },  # required\n  },\n  \"output\": \"\",  # Optional, one of \"minimal\" or \"verbose\". Defaults to \"minimal\".\n  \"dryRun\":   # Optional. If true, objects will not be deleted yet, but merely listed. Defaults to \"false\".\n}\n```\n\nPossible values for `output`:\n\n| Value | Effect |\n| ----- | ------ |\n| `minimal` | The result only includes counts. Information about objects is omitted if the deletes were successful. Only if an error occurred, will the object be described. |\n| `verbose` | The result lists all affected objects with their ID and deletion status, including both successful and unsuccessful deletes. |\n\n\n#### A response body in detail\n\n```yaml\n{\n  \"match\": {\n    \"class\": \"\",        # matches the request\n    \"where\": { /* where filter object */ },  # matches the request\n  },\n  \"output\": \"\",  # matches the request\n  \"dryRun\": ,\n  \"results\": {\n    \"matches\": \"\",            # how many objects were matched by the filter\n    \"limit\": \"\",              # the most amount of objects that can be deleted in a single query, matches QUERY_MAXIMUM_RESULTS\n    \"successful\": \"\",         # how many objects were successfully deleted in this round\n    \"failed\": \"\",             # how many objects should have been deleted but could not be deleted\n    \"objects\": [{                  # one JSON object per weaviate object\n      \"id\": \"\",                # this successfully deleted object would be omitted with output=minimal\n      \"status\": \"SUCCESS\",         # possible status values are: \"SUCCESS\", \"FAILED\", \"DRYRUN\"\n      \"error\": null\n    }, {\n      \"id\": \"\",                # this error object will always be listed, even with output=minimal\n      \"status\": \"FAILED\",\n      \"errors\": {\n         \"error\": [{\n             \"message\": \"\"\n         }]\n      }\n    }]\n  }\n}\n```\n\n\n### Example request\n\n\n\n\n## Error handling\n\nYou can check if an error occurred, and of what kind.\n\nErrors may occur on a batch request, for example when the connection to Weaviate is lost or when there is a mistake in any data objects.\n\nA batch request will always return an HTTP `200` status code when the batch request was successful. This indicates that:\n- The batch was successfully sent to Weaviate.\n- There were no issues with the connection or processing of the batch.\n- The request was not malformed (`4xx` status code).\n\nHowever, a `200` status code does not guarantee that each batch item has been added/created. For example, adding an object to the batch that is in conflict with the schema (for example a non-existing collection name) will cause an error.\n\nAccordingly, we recommend you check the response body for errors.\n\n\n## Python client library\n\nThe Weaviate Python client library provides additional functionalities for batch imports. For example, the latest Python client library supports various batching modes, as well as improved error handling.\n\nPlease refer to the client documentation for more detail.\n\n\n\n## Notes\n\n\n\n\n\n", "type": "Documentation", "name": "rest-batch", "path": "developers/weaviate/api/rest/batch.md", "link": "https://weaviate.io/developers/weaviate/api/rest/batch", "timestamp": "2024-02-08 21:20:48", "reader": "JSON", "meta": {}, "chunks": []}