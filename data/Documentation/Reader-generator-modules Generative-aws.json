{"text": "\n\n## In short\n\n\n* The Generative AWS (`generative-aws`) module performs retrieval augmented generation, or RAG, based on the data stored in your Weaviate instance.\n* The module can generate a response for each object returned from Weaviate, or a combined response for a group of objects.\n* The module enables generative search operations on the Weaviate instance.\n\n### API Authentication\n\nYou must provide [access key based AWS credentials](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html) to use the API, including an AWS access key and a corresponding AWS secret access key. You can [set them as environment variables](#parameters), or [provide them at query time](#query-time-parameters).\n\n## Introduction\n\n`generative-aws` performs retrieval augmented generation, or RAG, based on the data stored in your Weaviate instance.\n\nThe module works in two steps:\n1. (Weaviate) Run a search query in Weaviate to find relevant objects.\n2. (AWS Bedrock) Use a Large Language Model to generate a response based on the results (from the previous step) and the provided prompt or task.\n\nYou can use the Generative AWS module with any other upstream modules. For example, you could use `text2vec-cohere`, `text2vec-huggingface` or `text2vec-openai` to vectorize and query your data, but then rely on the `generative-aws` module to generate a response.\n\nThe generative module can perform RAG for:\n* each returned object - `singlePrompt`\n* the group of all results together \u2013 `groupedTask`\n\nYou need to input both a query and a prompt (for individual responses) or a task (for all responses).\n\n\n## Weaviate instance configuration\n\nIf you use Weaviate Cloud Services (WCS), this module is already enabled and pre-configured. You cannot edit the configuration in WCS.\n\n### Docker Compose file\n\nTo use `generative-aws`, you must enable it in your Docker Compose file (`docker-compose.yml`). You can do so manually, or create one using the [Weaviate configuration tool](/developers/weaviate/installation/docker-compose.md#configurator).\n\n#### Parameters\n\n- `ENABLE_MODULES` (Required): The modules to enable. Include `generative-aws` to enable the module.\n- `AWS_ACCESS_KEY` or `AWS_ACCESS_KEY_ID` (Optional): Your AWS access key. You can also provide the key at query time.\n- `AWS_SECRET_KEY` or `AWS_SECRET_ACCESS_KEY` (Optional): Your AWS secret access key. You can also provide the key at query time.\n\n#### Example\n\nThis configuration enables `generative-aws` and sets the AWS authentication credentials.\n\n```yaml\n---\nversion: '3.4'\nservices:\n  weaviate:\n    command:\n    - --host\n    - 0.0.0.0\n    - --port\n    - '8080'\n    - --scheme\n    - http\n    image: cr.weaviate.io/semitechnologies/weaviate:||site.weaviate_version||\n    ports:\n    - 8080:8080\n    - 50051:50051\n    volumes:\n    - weaviate_data:/var/lib/weaviate\n    restart: on-failure:0\n    environment:\n      QUERY_DEFAULTS_LIMIT: 25\n      AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED: 'true'\n      PERSISTENCE_DATA_PATH: '/var/lib/weaviate'\n      DEFAULT_VECTORIZER_MODULE: text2vec-aws\n      # highlight-start\n      AWS_ACCESS_KEY: sk-foobar  # Optional. Can be set at query time.\n      AWS_SECRET_KEY: sk-foobar  # Optional. Can be set at query time.\n      ENABLE_MODULES: 'text2vec-aws,generative-aws'\n      # highlight-end\n      CLUSTER_HOSTNAME: 'node1'\nvolumes:\n  weaviate_data:\n...\n```\n\n\n## Class configuration\n\nYou can configure how the module will behave in each class through the [Weaviate schema](/developers/weaviate/manage-data/collections.mdx).\n\n[See this page](../../manage-data/collections.mdx#specify-a-generative-module) for code examples on how to specify a generative module.\n\n### API settings\n\n#### Parameters\n\n| Parameter | Required | Default | Purpose |\n| :- | :- | :- | :- |\n| `model` | No | NONE | The model to use. You must provide an available & supported model name. |\n| `region` | Yes | NONE | AWS region name, e.g. `us-east-1`. |\n\n#### Example\n\nThe following example configures the `Document` class to use the `generative-aws` module with the `Document` class, with the `command-xlarge-nightly` model and the AWS region to `us-east-1`.\n\n```json\n{\n  \"classes\": [\n    {\n      \"class\": \"Document\",\n      \"description\": \"A class called document\",\n      ...,\n      \"moduleConfig\": {\n        // highlight-start\n        \"generative-aws\": {\n          \"model\": \"cohere.command-text-v14\",  // REQUIRED\n          \"region\": \"us-east-1\"                // REQUIRED\n        },\n        // highlight-end\n      }\n    }\n  ]\n}\n```\n\n\n  New to Weaviate Schemas?\n\nIf you are new to Weaviate, check out the [Weaviate schema tutorial](/developers/weaviate/starter-guides/schema.md).\n\n\n\n\n## How to use\n\n### Query-time parameters\n\nYou can supply parameters at query time by adding it to the HTTP header.\n\n| HTTP Header | Value | Purpose | Note |\n| :- | :- | :- | :- |\n| `\"X-AWS-Access-Key\"` | `\"YOUR-AWS-API-ACCESS-KEY\"` | Your AWS access key. | |\n| `\"X-AWS-Secret-Key\"` | `\"YOUR-AWS-API-SECRET-KEY\"` | Your AWS secret access key | |\n\n### Queries\n\nThis module extends the  `_additional {...}` property with a `generate` operator.\n\n`generate` takes the following arguments:\n\n| Field | Data Type | Required | Example | Description |\n|- |- |- |- |- |\n| `singleResult {prompt}`  | string | no | `Summarize the following in a tweet: {summary}`  | Generates a response for each individual search result. You need to include at least one result field in the prompt, between braces. |\n| `groupedResult {task}`  | string | no | `Explain why these results are similar to each other`  | Generates a single response for all search results |\n\n#### Example of properties in the prompt\n\nWhen piping the results to the prompt, at least one field returned by the query must be added to the prompt. If you don't add any fields, Weaviate will throw an error.\n\nFor example, assume your schema looks like this:\n\n```graphql\n{\n  Article {\n    title\n    summary\n  }\n}\n```\n\nYou can add both `title` and `summary` to the prompt by enclosing them in curly brackets:\n\n```graphql\n{\n  Get {\n    Article {\n      title\n      summary\n      _additional {\n        generate(\n          singleResult: {\n            prompt: \"\"\"\n            Summarize the following in a tweet:\n\n            {title} - {summary}\n            \"\"\"\n          }\n        ) {\n          singleResult\n          error\n        }\n      }\n    }\n  }\n}\n```\n\n#### Example - single result\n\nHere is an example of a query where:\n* we run a vector search (with `nearText`) to find articles about \"Italian food\"\n* then we ask the generator module to describe each result as a Facebook ad.\n  * the query asks for the `summary` field, which it then includes in the `prompt` argument of the `generate` operator.\n\n\n\n#### Example response - single result\n\n```json\n{\n  \"data\": {\n    \"Get\": {\n      \"Article\": [\n        {\n          \"_additional\": {\n            \"generate\": {\n              \"error\": null,\n              \"singleResult\": \"Italian food, as we know it today, might be a relatively modern concept. But it's hard to deny that there's something special about it. It could be the way the pasta tastes or the way the sauce smells. It could be the way the cheese stretches or the way the bread soaks up the sauce. Whatever it is, Italian food has a way of capturing our hearts and our stomachs. So if you're looking for a way to spice up your meal routine, why not try Italian? You might just find that it's your new favorite cuisine.\"\n            }\n          },\n          \"summary\": \"Even the emoji for pasta isn't just pasta -- it's a steaming plate of spaghetti heaped with tomato sauce on top. But while today we think of tomatoes as inextricably linked to Italian food, that hasn't always been the case. \\\"People tend to think Italian food was always as it is now -- that Dante was eating pizza,\\\" says Dr Eva Del Soldato , associate professor of romance languages at the University of Pennsylvania, who leads courses on Italian food history. In fact, she says, Italy's complex history -- it wasn't unified until 1861 -- means that what we think of Italian food is, for the most part, a relatively modern concept. Diego Zancani, emeritus professor of medieval and modern languages at Oxford University and author of \\\"How We Fell in Love with Italian Food,\\\" agrees.\",\n          \"title\": \"How this fruit became the star of Italian cooking\"\n        }\n      ]\n    }\n  }\n}\n```\n\n#### Example - grouped result\n\nHere is an example of a query where:\n* we run a vector search (with `nearText`) to find publications about finance,\n* then we ask the generator module to explain why these articles are about finance.\n\n\n\n#### Example response - grouped result\n\n```json\n{\n  \"data\": {\n    \"Get\": {\n      \"Publication\": [\n        {\n          \"_additional\": {\n            \"generate\": {\n              \"error\": null,\n              \"groupedResult\": \"These magazines or newspapers are about finance because they cover topics related to finance, such as business news, financial markets, and economic trends. They also often feature articles about personal finance, such as investing, budgeting, and retirement planning.\"\n            }\n          },\n          \"name\": \"Financial Times\"\n        },\n        {\n          \"_additional\": {\n            \"generate\": null\n          },\n          \"name\": \"Wall Street Journal\"\n        },\n        {\n          \"_additional\": {\n            \"generate\": null\n          },\n          \"name\": \"The New York Times Company\"\n        }\n      ]\n    }\n  }\n}\n```\n\n\n## Additional information\n\n### Supported models\n\nYou can use any of the following models with `generative-aws`:\n\n* cohere.command-text-v14\n* cohere.command-light-text-v14\n\n\n\n", "type": "Documentation", "name": "Reader-generator-modules Generative-aws", "path": "developers/weaviate/modules/reader-generator-modules/generative-aws.md", "link": "https://weaviate.io/developers/weaviate/modules/reader-generator-modules/generative-aws", "timestamp": "2024-05-08 10:50:19", "reader": "JSON", "meta": {}, "chunks": []}