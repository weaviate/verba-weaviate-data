{"text": "Laura Ham from Semi Technology explains how to use Weaviate with Jina AI's DocArray. Learn how to set it up easily yourself so ... \nhi everyone i'm laura from semi technologies and\u00a0\nin this video i will explain you how to use vvas\u00a0\u00a0with gene ii's doc array so docker a is a\u00a0\nlibrary to handle unstructured data and to\u00a0\u00a0process it embed it and search through it really\u00a0\nefficiently so it's a pythonic api and with this\u00a0\u00a0library you can use various document stores to\u00a0\nstore the data one of the document stores is wev8wev8 is a vector search engine and as a vector\u00a0\ndatabase it's you can store and retrieve data\u00a0\u00a0really fast and it's scalable so it's a good\u00a0\nchoice if you go for a large data set in docker a\u00a0\u00a0so for this demo i prepared a jupyter notebook\u00a0\nyou can find the code and some example\u00a0\u00a0that are in this repository which will be the\u00a0\nlink will be in the description of this videoin this example i will do a similar image\u00a0\nsearch with fashion images from the h m\u00a0\u00a0fashion dataset which is available from kaggleokay so before we go to the notebook it's\u00a0\nimportant to have a rev8 instance running\u00a0\u00a0so the document storethere are two options to achieve this first\u00a0\nyou can run revit locally in this case you\u00a0\u00a0need to have token compose installed and\u00a0\nthe other option is to run a viviet instance\u00a0\u00a0on the cloud so i will show you both options\u00a0\ni included in the repository a docker compose\u00a0\u00a0file for abbreviate and the only thing\u00a0\nyou need to do is run docker compose upto start this viv88 instance and\u00a0\nthen it is running on localhost 8080\u00a0\u00a0so the other option is to run vv8 from the cloud\u00a0\nusing vva cloud service for this you need to\u00a0\u00a0create an account on refit cloud service\u00a0\nyou can go to console.samitel technologyso if you're signed in you\u00a0\ncan create a new eva cluster\u00a0\u00a0and that's for free so you can choose a name herewhich will also be the the server name\u00a0\nor the url of your abbreviate instanceimportant here is to choose none when it asks\u00a0\nfor the machine learning model to vectorize data\u00a0\u00a0because we will do this in doc arrayso you can choose authentication\u00a0\u00a0and we don't want any demo data set\u00a0\nloaded in and then you can createum so for now i have it running\u00a0\nlocally let's go to the python notebookyou need to have only two libraries installed\u00a0\nif you install docker a full it also installs\u00a0\u00a0vga's client for you so that's really\u00a0\nconvenient and we use storage vision to\u00a0\u00a0load in the machine learning modelso first let's load in docker a then we would do\u00a0\nsome configuration so um i set some variables for\u00a0\u00a0the data let's only load in like 50 images for\u00a0\nnow so we can walk through this demo really fast\u00a0\u00a0you define where the data is located and i also\u00a0\ndefine already which image i will use for queryingso as mentioned we have the review running on\u00a0\nlocalhost port 8080 in case you have a weave\u00a0\u00a0yet instance running on some other location you\u00a0\nyeah need to change the the host location here\u00a0\u00a0so this initiates the document array we\u00a0\nsee now that there are no documents in\u00a0\u00a0there yet because we just initiated\u00a0\nit and we're using vv8 as backendso now let's load in data we will\u00a0\nuse docker arrays function from files\u00a0\u00a0we choose a data path that we defined only 50\u00a0\ndocuments and we use vv8 as our storage mechanismso we see we have 50 documents now in documentary\u00a0\nso those are the 50 unpre-processed images\u00a0\u00a0oh sorry and we can see them over here so it's\u00a0\nvarious types of clothing then we define a\u00a0\u00a0preprocessing method we want the the images to\u00a0\nbe smaller to handle them fast with the machine\u00a0\u00a0learning model we normalize the color and change\u00a0\nthe axis and then we can use documents or dog\u00a0\u00a0arrays apply function to use this preprocessing\u00a0\nfunction to all the documents really fastso now it pre-processed the 50\u00a0\ndocuments that we have in therenext we we will use a machine learning\u00a0\nmodel to create vectors for each image\u00a0\u00a0which is also called embedding or encodingi use cpu here but if you have a gpu available\u00a0\nit will recognize this if you use this functionwe use a resnet 50 model and we use\u00a0\ntorch vision to load in this model\u00a0\u00a0and next we can use docs array embed method to\u00a0\nembed all the documents that we have saved in\u00a0\u00a0vvate with the machine learning model with\u00a0\nthe cpu and in this case batch size of 20.okay so in 7 seconds we have\u00a0\nall the 50 images embeddedthis step is optional but i removed the tensor\u00a0\nhere from all the images because now we have\u00a0\u00a0the vector and by removing the tensor we free\u00a0\nup a lot of memory which will fasten the query\u00a0\u00a0later on so i recommend you to do this\u00a0\nas well because we don't need the tensor\u00a0\u00a0anymore okay so next we can query the data\u00a0\nset because now we have all the data loaded inand as i told you before the query image url is\u00a0\nalready defined above so in this case we will\u00a0\u00a0be querying with this image and the goal\u00a0\nis to find similar images to this imageso we apply the same pre-processing steps\u00a0\nwe embed the model as well because we\u00a0\u00a0want a vector for this query as well and\u00a0\nthen you can find doc arrays find methodto find similar images in the\u00a0\ndocs that we have saved in vvate\u00a0\u00a0with the document query and\u00a0\nthis case a limit of five imagesokay and then we plot the images that we have as a\u00a0\nresult so as you can see this are quite similar to\u00a0\u00a0the query image and it's retrieving from\u00a0\nonly 50 images so i think it did a well job\u00a0\u00a0and that's of course done by resnet 50 model in\u00a0\ncombination with the vector search engine vvateokay that's it you can play around with\u00a0\nit this a bit you can find the link of\u00a0\u00a0the document of the notebook in in the\u00a0\ndescription of the video okay thank you", "type": "Video", "name": "Weaviate + Jina AI for Image Search presented by Laura Ham", "path": "", "link": "https://www.youtube.com/watch?v=rBKvoIGihnY", "timestamp": "", "reader": "JSON", "meta": {}, "chunks": []}